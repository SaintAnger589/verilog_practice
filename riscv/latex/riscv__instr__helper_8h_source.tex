\hypertarget{riscv__instr__helper_8h_source}{}\doxysection{riscv\+\_\+instr\+\_\+helper.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <bitset>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}testbench/ram.h"{}}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#ifndef RISCV\_HELPER}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#define RISCV\_HELPER}}
\DoxyCodeLine{11 \textcolor{keyword}{class }\mbox{\hyperlink{classriscv__instr__helper}{riscv\_instr\_helper}} \{}
\DoxyCodeLine{12 \textcolor{keyword}{private}:}
\DoxyCodeLine{13   int32\_t instr;}
\DoxyCodeLine{14   \textcolor{keywordtype}{int} bits\_instr[32];}
\DoxyCodeLine{15   \textcolor{keywordtype}{int} trace;}
\DoxyCodeLine{16 \textcolor{keyword}{public}:}
\DoxyCodeLine{17   ram mem;}
\DoxyCodeLine{18   \mbox{\hyperlink{classriscv__instr__helper}{riscv\_instr\_helper}}()\{}
\DoxyCodeLine{19     set\_instr(0);}
\DoxyCodeLine{20     debug\_on(\textcolor{keyword}{true});}
\DoxyCodeLine{21   \}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23   \textcolor{keywordtype}{void} set\_mem\_obj(ram mem)\{}
\DoxyCodeLine{24     this-\/>mem = mem;}
\DoxyCodeLine{25   \}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   \textcolor{keywordtype}{void} debug\_on(\textcolor{keywordtype}{bool} trace) \{}
\DoxyCodeLine{28     this-\/>trace = trace;}
\DoxyCodeLine{29   \}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{keywordtype}{void} set\_instr(int32\_t instruction)\{}
\DoxyCodeLine{32     instr = instruction;}
\DoxyCodeLine{33   \}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   \textcolor{keywordtype}{int} get\_funct7()\{}
\DoxyCodeLine{36     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{37     \textcolor{keywordtype}{int} funct7;}
\DoxyCodeLine{38     funct7 = 0;}
\DoxyCodeLine{39     \textcolor{keywordflow}{for} (i=25;i<32;i++)\{}
\DoxyCodeLine{40       funct7 = funct7 + (instr \& (1<<i));}
\DoxyCodeLine{41     \}}
\DoxyCodeLine{42     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{43       std::bitset<32> y(funct7);}
\DoxyCodeLine{44       cout<<\textcolor{stringliteral}{"{}funct7 = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{45     \}}
\DoxyCodeLine{46     \textcolor{keywordflow}{return} funct7;}
\DoxyCodeLine{47   \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49   \textcolor{keywordtype}{int} get\_rs2\_loc()\{}
\DoxyCodeLine{50     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{51     \textcolor{keywordtype}{int} rs2;}
\DoxyCodeLine{52     rs2 = 0;}
\DoxyCodeLine{53     \textcolor{keywordflow}{for} (i=20;i<25;i++)\{}
\DoxyCodeLine{54       rs2 = rs2 + (instr \& (1<<i));}
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{57       std::bitset<32> y(rs2);}
\DoxyCodeLine{58       cout<<\textcolor{stringliteral}{"{}rs2 = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{59     \}}
\DoxyCodeLine{60     \textcolor{keywordflow}{return} rs2;}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{keywordtype}{int} get\_rs1\_loc()\{}
\DoxyCodeLine{64     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{65     \textcolor{keywordtype}{int} rs1;}
\DoxyCodeLine{66     rs1 = 0;}
\DoxyCodeLine{67     \textcolor{keywordflow}{for} (i=15;i<20;i++)\{}
\DoxyCodeLine{68       rs1 = rs1 + (instr \& (1<<i));}
\DoxyCodeLine{69     \}}
\DoxyCodeLine{70     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{71       std::bitset<32> y(rs1);}
\DoxyCodeLine{72       cout<<\textcolor{stringliteral}{"{}rs1 = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{73     \}}
\DoxyCodeLine{74     \textcolor{keywordflow}{return} rs1;}
\DoxyCodeLine{75   \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   \textcolor{keywordtype}{int} get\_funct3()\{}
\DoxyCodeLine{78     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{79     \textcolor{keywordtype}{int} funct3;}
\DoxyCodeLine{80     funct3 = 0;}
\DoxyCodeLine{81     \textcolor{keywordflow}{for} (i=12;i<15;i++)\{}
\DoxyCodeLine{82       funct3 = funct3 + (instr \& (1<<i));}
\DoxyCodeLine{83     \}}
\DoxyCodeLine{84     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{85       std::bitset<32> y(funct3);}
\DoxyCodeLine{86       cout<<\textcolor{stringliteral}{"{}funct3 = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{87     \}}
\DoxyCodeLine{88     \textcolor{keywordflow}{return} funct3;}
\DoxyCodeLine{89   \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 }
\DoxyCodeLine{92   \textcolor{keywordtype}{int} get\_rd\_loc()\{}
\DoxyCodeLine{93     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{94     \textcolor{keywordtype}{int} rd;}
\DoxyCodeLine{95     rd = 0;}
\DoxyCodeLine{96     \textcolor{keywordflow}{for} (i=8;i<13;i++)\{}
\DoxyCodeLine{97       rd = rd + (instr \& (1<<i));}
\DoxyCodeLine{98     \}}
\DoxyCodeLine{99     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{100       std::bitset<32> y(rd);}
\DoxyCodeLine{101       cout<<\textcolor{stringliteral}{"{}rd = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{102     \}}
\DoxyCodeLine{103     \textcolor{keywordflow}{return} rd;}
\DoxyCodeLine{104   \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106   \textcolor{keywordtype}{int} get\_opcode()\{}
\DoxyCodeLine{107     cout<<\textcolor{stringliteral}{"{}helper::instr = "{}}<<instr<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{110     \textcolor{keywordtype}{int} opcode;}
\DoxyCodeLine{111     opcode = 0;}
\DoxyCodeLine{112     \textcolor{keywordflow}{for} (i=0;i<7;i++)\{}
\DoxyCodeLine{113       opcode = opcode + (instr \& (1<<i));}
\DoxyCodeLine{114     \}}
\DoxyCodeLine{115     \textcolor{keywordflow}{if} (trace)\{}
\DoxyCodeLine{116       std::bitset<32> y(opcode);}
\DoxyCodeLine{117       cout<<\textcolor{stringliteral}{"{}opcode = "{}}<<y<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{118     \}}
\DoxyCodeLine{119     \textcolor{keywordflow}{return} opcode;}
\DoxyCodeLine{120   \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122   \textcolor{keywordtype}{int} get\_rs1\_val(\textcolor{keywordtype}{int} rs1\_loc) \{}
\DoxyCodeLine{123     \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{124     cout<<\textcolor{stringliteral}{"{}helper::get\_rs1\_val: rs1\_loc = "{}}<<rs1\_loc<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{125     res = mem.get\_mem\_val(rs1\_loc);}
\DoxyCodeLine{126     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{127   \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 }
\DoxyCodeLine{130   \textcolor{keywordtype}{int} get\_rs2\_val(\textcolor{keywordtype}{int} rs2\_loc) \{}
\DoxyCodeLine{131     \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{132     cout<<\textcolor{stringliteral}{"{}helper::get\_rs2\_val: rs1\_loc = "{}}<<rs2\_loc<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{133     res = mem.get\_mem\_val(rs2\_loc);}
\DoxyCodeLine{134     cout<<\textcolor{stringliteral}{"{}helper::get\_rs2\_val rs2\_val = "{}}<<res<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{135     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{136   \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138   \textcolor{keywordtype}{int} get\_rd\_val(\textcolor{keywordtype}{int} rd\_loc) \{}
\DoxyCodeLine{139     \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{140     res = mem.get\_mem\_val(rd\_loc);}
\DoxyCodeLine{141     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{142   \}}
\DoxyCodeLine{143 }
\DoxyCodeLine{144   \textcolor{keywordtype}{void} set\_rd\_val(\textcolor{keywordtype}{int} rd\_loc, \textcolor{keywordtype}{int} val)\{}
\DoxyCodeLine{145     cout<<\textcolor{stringliteral}{"{}helper::rd\_loc = "{}}<<rd\_loc<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{146     cout<<\textcolor{stringliteral}{"{}helper::rd\_val = "{}}<<val<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{147     mem.set\_mem\_val(rd\_loc, val);}
\DoxyCodeLine{148   \}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \};}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
